<!DOCTYPE html>
<html>
<head>
    <title>SVG Rectangle Test</title>
</head>
<body>
    <h1>Testing SVG Rectangle Rendering</h1>

    <svg id="test-svg" xmlns="http://www.w3.org/2000/svg" width="800" height="600" style="border: 2px solid blue;">
        <!-- Test if rectangles render at all -->
        <rect x="50" y="50" width="100" height="200" fill="yellow" stroke="black" stroke-width="2"/>
        <rect x="200" y="50" width="100" height="200" fill="red"/>
        <rect x="350" y="50" width="100" height="200" fill="green" opacity="1"/>

        <!-- Test polygon -->
        <polygon points="100,350 150,450 50,450" fill="red"/>

        <!-- Test text -->
        <text x="250" y="400" style="font-size: 30px; fill: black;">TEST TEXT</text>
    </svg>

    <button onclick="addRect()">Add Rectangle via JS</button>
    <button onclick="checkElements()">Check SVG Elements</button>

    <script>
        function addRect() {
            const svg = document.getElementById('test-svg');
            const rect = document.createElementNS('http://www.w3.org/2000/svg', 'rect');
            rect.setAttribute('x', '500');
            rect.setAttribute('y', '50');
            rect.setAttribute('width', '100');
            rect.setAttribute('height', '200');
            rect.setAttribute('fill', 'purple');
            svg.appendChild(rect);
            console.log('Added purple rectangle at x=500');
        }

        function checkElements() {
            const svg = document.getElementById('test-svg');
            const rects = svg.querySelectorAll('rect');
            const polygons = svg.querySelectorAll('polygon');

            console.log('Found elements in SVG:');
            console.log('Rectangles:', rects.length);
            console.log('Polygons:', polygons.length);

            rects.forEach((rect, i) => {
                const bbox = rect.getBBox();
                const computed = window.getComputedStyle(rect);
                console.log(`Rect ${i}:`, {
                    x: rect.getAttribute('x'),
                    y: rect.getAttribute('y'),
                    width: rect.getAttribute('width'),
                    height: rect.getAttribute('height'),
                    fill: rect.getAttribute('fill'),
                    computed_fill: computed.fill,
                    computed_display: computed.display,
                    bbox: bbox
                });
            });
        }

        // Check on load
        window.addEventListener('DOMContentLoaded', () => {
            checkElements();
        });
    </script>
</body>
</html>