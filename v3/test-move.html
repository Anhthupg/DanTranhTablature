<!DOCTYPE html>
<html>
<head>
    <title>Test Move Function</title>
    <style>
        .collapsible-panel {
            background: #f5f5f5;
            margin: 10px;
            padding: 10px;
            border: 1px solid #ccc;
            order: 0;
        }
        .panel-header {
            cursor: pointer;
            background: #e0e0e0;
            padding: 10px;
        }
        .move-arrow {
            background: #2c3e50;
            color: white;
            border: none;
            padding: 5px 10px;
            cursor: pointer;
            margin-right: 5px;
        }
        #sectionContainer {
            display: flex;
            flex-direction: column;
        }
    </style>
</head>
<body>
    <h1>Test Section Movement</h1>
    <div id="sectionContainer">
        <div id="section1Panel" class="collapsible-panel" style="order: 0;">
            <div class="panel-header">
                <button class="move-arrow" onclick="moveSection('section1Panel', 'up'); event.stopPropagation();">▲</button>
                <button class="move-arrow" onclick="moveSection('section1Panel', 'down'); event.stopPropagation();">▼</button>
                Section 1
            </div>
        </div>

        <div id="section2Panel" class="collapsible-panel" style="order: 1;">
            <div class="panel-header">
                <button class="move-arrow" onclick="moveSection('section2Panel', 'up'); event.stopPropagation();">▲</button>
                <button class="move-arrow" onclick="moveSection('section2Panel', 'down'); event.stopPropagation();">▼</button>
                Section 2
            </div>
        </div>

        <div id="section3Panel" class="collapsible-panel" style="order: 2;">
            <div class="panel-header">
                <button class="move-arrow" onclick="moveSection('section3Panel', 'up'); event.stopPropagation();">▲</button>
                <button class="move-arrow" onclick="moveSection('section3Panel', 'down'); event.stopPropagation();">▼</button>
                Section 3
            </div>
        </div>
    </div>

    <script>
        // Test simplified moveSection function
        function moveSection(panelId, direction) {
            console.log(`Moving ${panelId} ${direction}`);

            const panel = document.getElementById(panelId);
            if (!panel) {
                console.error(`Panel not found: ${panelId}`);
                return;
            }

            // Get all collapsible panels
            const container = panel.parentElement;
            const panels = Array.from(container.querySelectorAll('.collapsible-panel'));

            // Get current orders
            const orders = panels.map(p => ({
                panel: p,
                order: parseInt(p.style.order) || 0
            })).sort((a, b) => a.order - b.order);

            // Find current panel index
            const currentIndex = orders.findIndex(o => o.panel === panel);
            console.log(`Current index: ${currentIndex} of ${orders.length} panels`);

            if (direction === 'up' && currentIndex > 0) {
                // Swap with previous
                const temp = orders[currentIndex].order;
                orders[currentIndex].order = orders[currentIndex - 1].order;
                orders[currentIndex - 1].order = temp;

                // Apply new orders
                orders[currentIndex].panel.style.order = orders[currentIndex].order;
                orders[currentIndex - 1].panel.style.order = orders[currentIndex - 1].order;

                console.log(`Moved ${panelId} up`);
            } else if (direction === 'down' && currentIndex < orders.length - 1) {
                // Swap with next
                const temp = orders[currentIndex].order;
                orders[currentIndex].order = orders[currentIndex + 1].order;
                orders[currentIndex + 1].order = temp;

                // Apply new orders
                orders[currentIndex].panel.style.order = orders[currentIndex].order;
                orders[currentIndex + 1].panel.style.order = orders[currentIndex + 1].order;

                console.log(`Moved ${panelId} down`);
            } else {
                console.log(`Cannot move ${panelId} ${direction} - at boundary`);
            }
        }

        // Make global
        window.moveSection = moveSection;

        console.log('Test page loaded. Try clicking the arrows or calling moveSection("section2Panel", "up") in console');
    </script>
</body>
</html>